(function (e, t, n) { var r = e(n), i = true; r.on("click", ".collapsible li, .collapsible li > span, .collapsible li > a", function (n) { if (n.target !== this) { return } var r = e(this), s = e(this).closest("li"), o = s.children("ul:first"), u = s.closest(".collapsible"), a, f, l, c; if (o.length > 0) { if (s.hasClass("collapsible-open")) { s.removeClass("collapsible-open"); if (i) { o.stop(true).css("overflow", "hidden").animate({ height: "0px" }, function () { o.css({ overflow: "", height: "" }).hide() }) } else { o.stop(true).hide() } if (s.hasClass("with-left-arrow") || s.hasClass("with-right-arrow")) { s.removeClass("arrow-up").addClass("arrow-down") } s.trigger("collapsible-close") } else { e(s.parentsUntil(".collapsible", "li").not(".collapsible-open").get().reverse()).click(); if (u.hasClass("as-accordion")) { s.siblings(".collapsible-open").click() } s.addClass("collapsible-open"); if (i) { c = o.stop(true).css({ display: "block", height: "" }).height(); o.css({ overflow: "hidden", height: "0px" }).animate({ height: c + "px" }, function () { o.css({ overflow: "", height: "" }) }) } else { o.stop(true).css({ overflow: "", height: "" }).show() } if (s.hasClass("with-left-arrow") || s.hasClass("with-right-arrow")) { s.removeClass("arrow-down").addClass("arrow-up") } s.trigger("collapsible-open") } n.preventDefault() } else if (r.hasClass("collapsible-ajax")) { if (s.children(".load").length) { return } l = r.is("a") ? r.attr("href") : r.data("collapsible-url"); if (l && typeof l === "string" && e.trim(l).length > 0 && l.substr(0, 1) !== "#") { a = e('<div class="load"></div>').appendTo(s); if (i) { c = a.height(); a.css({ overflow: "hidden", height: "0px" }).animate({ height: c + "px" }, function () { o.css({ overflow: "", height: "" }) }) } e.ajax(l, { error: function (e, n, r) { if (t.notify) { t.notify('Menu loading failed with the status "' + n + '"') } if (i) { a.stop(true).css({ overflow: "hidden" }).animate({ height: "0px" }, function () { a.remove() }) } else { a.remove() } }, success: function (e, t, n) { r.removeClass("collapsible-ajax").addClass("collapsible-ajax-loaded"); s.append(e); r.click(); if (i) { a.stop(true).css({ overflow: "hidden" }).animate({ height: "0px" }, function () { a.remove() }) } else { a.remove() } } }); n.preventDefault() } } else if (r.hasClass("collapsible-ajax-loaded")) { n.preventDefault() } }); e.template.addSetupFunction(function (t, n) { this.findIn(t, n, ".collapsible li").addClass("arrow-down"); this.findIn(t, n, ".collapsible-current").each(function (t) { var n = e(this).closest("ul").closest("li, .collapsible"), r; if (n.length > 0 && !n.hasClass("collapsible")) { i = false; r = n.children("a, span").first(); if (r.length > 0) { r.click() } else { n.click() } i = true } }); return this }) })(jQuery, window, document)