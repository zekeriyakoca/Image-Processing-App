(function (e, t, n) { var r = e(n), i = true; r.on("click", ".navigable li, .navigable li > span, .navigable li > a, .navigable li > b", function (n) { if (n.target !== this) { return } var r = e(this), s = e(this).closest("li"), o = s.children("ul:first"), u = s.parentsUntil(".navigable", "ul"), a = u.eq(0), f = u.eq(-1), l = f.closest(".navigable"), c = e.extend({}, e.template.navigable, l.data("navigable-options")), h = l.children(".back"), p, d = l.children(".load"), v, m, g, y, b, w, E; if (!f.hasClass("fixed")) { l.height(f.outerHeight(true)); f.addClass("fixed") } if (h.length === 0) { y = c.backText || " "; h = e('<div class="back"><span class="back-arrow"></span><span class="back-text">' + y + "</span></div>").prependTo(l).click(function (e) { var t = l.data("navigableCurrent"), n, r, s, o, u; if (!t) { h.stop(true)[i ? "animate" : "css"]({ marginTop: -h.outerHeight() + "px" }); return } n = t.parent().closest("ul"); if (n.hasClass("fixed")) { r = 0; s = 0; l.removeData("navigableCurrent"); h.stop(true)[i ? "animate" : "css"]({ marginTop: -h.outerHeight() + "px" }) } else { if (c.backText) { p.text(c.backText) } else { o = n.closest("li"); u = o.children("a, b, span").not(".icon").first(); if (!u.length) { u = o } p.text(u.contents().filter(function () { return this.nodeType == 3 }).text()) } r = -n.parentsUntil(".navigable", "ul").length * 100; s = h.outerHeight(); l.data("navigableCurrent", n) } l.stop(true)[i ? "animate" : "css"]({ height: n.outerHeight(true) + s + "px" }); f.stop(true)[i ? "animate" : "css"]({ left: r + "%" }); t.parent().closest("li").trigger("navigable-close") }); h.css({ marginTop: -h.outerHeight() + "px" }) } p = h.children(".back-text"); if (d.length > 0) { v = l.data("navigableCurrent") || f; f.stop(true)[i ? "animate" : "css"]({ left: -(v.parentsUntil(".navigable", "ul").length * 100) + "%" }, "fast"); d.stop(true).removeData("navigable-target"); if (i) { d.animate({ right: "-10%" }, "fast", function () { d.remove(); r.click() }); n.preventDefault(); return } else { d.remove() } } if (o.length > 0) { b = l.tempShow(); if (a.outerHeight(true) === 0 && u.length < 3) { g = function () { if (a.outerHeight(true) > 0) { i = false; r.click(); i = true } else { setTimeout(g, 40) } }; setTimeout(g, 40); return } l.data("navigableCurrent", o); a.find("ul").hide(); u.show(); o.show(); o.add(u.not(":last")).each(function (t) { var n = e(this), r = n.parent(); if (e.inArray(r.css("position"), ["relative", "absolute"]) > -1) { n.css("top", -r.position().top + "px") } }); if (c.backText) { p.text(c.backText) } else { w = s; E = w.children("a, b, span").not(".icon").first(); if (!E.length) { E = w } p.text(E.contents().filter(function () { return this.nodeType == 3 }).text()) } l.stop(true).height(a.outerHeight(true) + h.outerHeight(true))[i ? "animate" : "css"]({ height: o.outerHeight(true) + h.outerHeight() + "px" }); f.stop(true)[i ? "animate" : "css"]({ left: -(u.length * 100) + "%" }); h[i ? "animate" : "css"]({ marginTop: 0 }); s.trigger("navigable-open"); b.tempShowRevert(); n.preventDefault() } else if (r.hasClass("navigable-ajax")) { m = r.is("a") ? r.attr("href") : r.data("navigable-url"); if (m && typeof m === "string" && e.trim(m).length > 0 && m.substr(0, 1) !== "#") { d = e('<div class="load" style="right: -10%"></div>').appendTo(l); d.data("navigable-target", this); f.stop(true)[i ? "animate" : "css"]({ left: -((u.length - 1) * 100 + 10) + "%" }); d[i ? "animate" : "css"]({ right: "0%" }); e.ajax(m, { error: function (e, n, s) { var o = l.children(".load"), u; if (t.notify) { t.notify('Menu loading failed with the status "' + n + '"') } if (o.length > 0 && o.data("navigable-target") === r[0]) { u = l.data("navigableCurrent") || f; f.stop(true)[i ? "animate" : "css"]({ left: -(u.parentsUntil(".navigable", "ul").length * 100) + "%" }, "fast"); o.stop(true).removeData("navigable-target"); if (i) { o.animate({ right: "-10%" }, "fast", function () { o.remove() }) } else { o.remove() } } }, success: function (e, t, n) { var i = l.children(".load"); r.removeClass("navigable-ajax").addClass("navigable-ajax-loaded"); s.append(e); if (i.length > 0 && i.data("navigable-target") === r[0]) { i.remove(); r.click() } r.trigger("navigable-ajax-loaded") } }); n.preventDefault() } } else if (r.hasClass("navigable-ajax-loaded")) { n.preventDefault() } }); e.fn.navigableReset = function () { this.filter(".navigable").each(function (t) { var n = e(this), r = n.children(".back"), i; if (r.length > 0) { i = n.tempShow(); while (n.data("navigableCurrent")) { r.click() } i.tempShowRevert() } }); return this }; e.template.addSetupFunction(function (t, n) { this.findIn(t, n, ".navigable-current").each(function (t) { var n = e(this).closest("ul").closest("li, .navigable"), r; if (n.length > 0 && !n.hasClass("navigable")) { i = false; r = n.children("a, span").first(); if (r.length > 0) { r.click() } else { n.click() } i = true } }); return this }); e.template.navigable = { backText: false } })(jQuery, window, document)